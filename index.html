<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ali.fx7777 Terminal</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body { background-color: #0b1016; color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .tab-active { background-color: #00ff88; color: black; font-weight: bold; }
        .card-bg { background-color: #171c26; border-radius: 18px; padding: 20px; border: 1px solid #242b37; }
        .signal-box { background-color: #111822; border-radius: 12px; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.05); }
        .tp-color { color: #00ff88; font-weight: bold; }
        .sl-color { color: #ff4444; font-weight: bold; }
        .nav-fixed { position: fixed; bottom: 0; width: 100%; background: #0b1016; border-top: 1px solid #1f2630; display: flex; justify-content: space-around; padding: 10px 0 25px 0; }
        .nav-item { text-align: center; color: #5b6371; font-size: 10px; }
        .nav-item.active { color: #00ff88; }
        .check-icon { color: #00ff88; font-size: 14px; }
    </style>
</head>
<body class="pb-24">

    <div class="flex gap-2 overflow-x-auto px-4 py-6 no-scrollbar">
        <button onclick="switchAsset('BTC')" id="tab-BTC" class="tab-btn tab-active px-5 py-2 rounded-full text-xs uppercase">BTC</button>
        <button onclick="switchAsset('ETH')" id="tab-ETH" class="tab-btn bg-[#1e2530] px-5 py-2 rounded-full text-xs uppercase">ETH</button>
        <button onclick="switchAsset('GOLD')" id="tab-GOLD" class="tab-btn bg-[#1e2530] px-5 py-2 rounded-full text-xs uppercase">Gold</button>
        <button onclick="switchAsset('EURUSD')" id="tab-EURUSD" class="tab-btn bg-[#1e2530] px-5 py-2 rounded-full text-xs uppercase">EURUSD</button>
    </div>

    <div class="px-4">
        <div class="card-bg mb-6">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 id="asset-name" class="text-xl font-bold tracking-tight">BTCUSD <span class="text-gray-500 text-sm font-normal ml-1">M15</span></h2>
                </div>
                <span id="signal-type" class="bg-green-500/10 text-green-500 px-3 py-1 rounded text-[10px] font-black uppercase tracking-widest border border-green-500/20">Buy</span>
            </div>

            <div class="flex justify-between text-xs text-gray-400 mb-6 px-1">
                <div>Kirish narxi: <span id="entry-price" class="text-white font-bold ml-2">--</span></div>
                <div><i class="far fa-clock mr-1"></i> <span id="signal-time">--</span></div>
            </div>

            <div class="space-y-2">
                <div class="signal-box">
                    <span class="text-xs font-bold text-gray-400 uppercase">TP 1</span>
                    <div class="flex items-center">
                        <span id="tp-1" class="tp-color mr-3">--</span>
                        <i class="fas fa-check-circle check-icon"></i>
                    </div>
                </div>
                <div class="signal-box">
                    <span class="text-xs font-bold text-gray-400 uppercase">TP 2</span>
                    <div class="flex items-center">
                        <span id="tp-2" class="tp-color mr-3">--</span>
                        <i class="fas fa-check-circle check-icon"></i>
                    </div>
                </div>
                <div class="signal-box">
                    <span class="text-xs font-bold text-gray-400 uppercase">TP 3</span>
                    <div class="flex items-center">
                        <span id="tp-3" class="tp-color mr-3">--</span>
                        <i class="fas fa-check-circle check-icon"></i>
                    </div>
                </div>
                <div class="signal-box bg-red-500/5 mt-4 border-red-500/10">
                    <span class="text-xs font-bold text-red-500 uppercase">Stop Loss</span>
                    <span id="stop-loss" class="text-white font-bold">--</span>
                </div>
            </div>
        </div>
    </div>

    <nav class="nav-fixed">
        <div class="nav-item"><i class="fas fa-home text-xl mb-1"></i><br>Bosh</div>
        <div class="nav-item active"><i class="fas fa-bolt text-xl mb-1"></i><br>Signal</div>
        <div class="nav-item"><i class="fas fa-copy text-xl mb-1"></i><br>CopyFX</div>
        <div class="nav-item"><i class="fas fa-user text-xl mb-1"></i><br>Profil</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let currentAsset = 'BTC';

        function switchAsset(asset) {
            currentAsset = asset;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('tab-active', 'bg-[#1e2530]'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.add('bg-[#1e2530]'));
            document.getElementById('tab-' + asset).classList.add('tab-active');
            document.getElementById('tab-' + asset).classList.remove('bg-[#1e2530]');
            document.getElementById('asset-name').innerHTML = asset + "USD <span class='text-gray-500 text-sm font-normal ml-1'>M15</span>";
            updateLiveSignal();
            tg.HapticFeedback.impactOccurred('light');
        }

        async function updateLiveSignal() {
            // Haqiqiy narxni Binance API orqali olamiz
            const pair = currentAsset === 'GOLD' ? 'BTCTUSD' : currentAsset + 'USDT';
            try {
                const res = await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${pair}`);
                const data = await res.json();
                let price = parseFloat(data.price);
                
                if(currentAsset === 'GOLD') price = (price / 25).toFixed(2);
                else price = price.toFixed(2);

                document.getElementById('entry-price').innerText = price;
                
                // Signal vaqtini hozirgi vaqtga sozlash
                const now = new Date();
                document.getElementById('signal-time').innerText = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0') + ":" + now.getSeconds().toString().padStart(2, '0');

                // TP va SL hisoblash (Aniq matematik algoritm)
                const p = parseFloat(price);
                document.getElementById('tp-1').innerText = (p + (p * 0.003)).toFixed(2);
                document.getElementById('tp-2').innerText = (p + (p * 0.006)).toFixed(2);
                document.getElementById('tp-3').innerText = (p + (p * 0.009)).toFixed(2);
                document.getElementById('stop-loss').innerText = (p - (p * 0.005)).toFixed(2);

            } catch (e) { console.log("Xatolik!"); }
        }

        setInterval(updateLiveSignal, 5000); // Har 5 soniyada yangilanadi
        updateLiveSignal();
    </script>
</body>
</html>
